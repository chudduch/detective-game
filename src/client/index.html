<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Детектив-Квартет | Кооперативная детективная игра</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Шапка -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-search"></i>
                <h1>Детектив-Квартет</h1>
            </div>
            <nav class="nav">
                <a href="#" id="nav-home">Главная</a>
                <a href="#" id="nav-lobby" style="display:none;">Лобби</a>
                <a href="#" id="nav-leaderboard">Рейтинг</a>
                <a href="#" id="nav-profile" style="display:none;">Профиль</a>
                <a href="#" id="nav-logout" style="display:none;">Выйти</a>
            </nav>
        </div>
    </header>

    <!-- Основной контент -->
    <main class="main">
        <div class="container">
            <!-- Экран приветствия (показывается по умолчанию) -->
            <section id="welcome-screen" class="screen active">
                <div class="welcome-card">
                    <div class="welcome-icon">
                        <i class="fas fa-user-secret"></i>
                    </div>
                    <h2>Раскройте тайну вместе!</h2>
                    <p class="subtitle">Кооперативная детективная игра для 4 игроков</p>
                    
                    <div class="features">
                        <div class="feature">
                            <i class="fas fa-users"></i>
                            <span>Команда из 4 детективов</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Сложные головоломки</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-trophy"></i>
                            <span>Рейтинг и достижения</span>
                        </div>
                    </div>
                    
                    <div class="auth-buttons">
                        <button class="btn btn-primary" id="show-login-btn">
                            <i class="fas fa-sign-in-alt"></i> Войти
                        </button>
                        <button class="btn btn-secondary" id="show-register-btn">
                            <i class="fas fa-user-plus"></i> Регистрация
                        </button>
                        <button class="btn btn-ghost" id="quick-play-btn">
                            <i class="fas fa-play"></i> Быстрый старт
                        </button>
                    </div>
                </div>
            </section>

            <!-- Экран входа -->
            <section id="login-screen" class="screen">
                <div class="auth-card">
                    <h2><i class="fas fa-sign-in-alt"></i> Вход в игру</h2>
                    
                    <form id="login-form">
                        <div class="form-group">
                            <label for="login-email">
                                <i class="fas fa-envelope"></i> Email
                            </label>
                            <input type="email" id="login-email" required 
                                   placeholder="detective@example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="login-password">
                                <i class="fas fa-lock"></i> Пароль
                            </label>
                            <input type="password" id="login-password" required 
                                   placeholder="Введите пароль">
                            <div class="password-toggle">
                                <i class="fas fa-eye" id="toggle-login-password"></i>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i> Войти
                        </button>
                        
                        <div class="auth-links">
                            <a href="#" id="show-register-from-login">
                                Нет аккаунта? Зарегистрироваться
                            </a>
                            <a href="#" id="forgot-password">
                                Забыли пароль?
                            </a>
                        </div>
                    </form>
                    
                    <button class="btn btn-ghost btn-block" id="back-to-welcome-from-login">
                        <i class="fas fa-arrow-left"></i> Назад
                    </button>
                </div>
            </section>

            <!-- Экран регистрации -->
            <section id="register-screen" class="screen">
                <div class="auth-card">
                    <h2><i class="fas fa-user-plus"></i> Регистрация</h2>
                    
                    <form id="register-form">
                        <div class="form-group">
                            <label for="register-email">
                                <i class="fas fa-envelope"></i> Email
                            </label>
                            <input type="email" id="register-email" required 
                                   placeholder="detective@example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="register-username">
                                <i class="fas fa-user"></i> Имя детектива
                            </label>
                            <input type="text" id="register-username" required 
                                   placeholder="Шерлок Холмс" minlength="2" maxlength="20">
                            <div class="hint">От 2 до 20 символов</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="register-password">
                                <i class="fas fa-lock"></i> Пароль
                            </label>
                            <input type="password" id="register-password" required 
                                   placeholder="Не менее 6 символов" minlength="6">
                            <div class="password-toggle">
                                <i class="fas fa-eye" id="toggle-register-password"></i>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="register-password-confirm">
                                <i class="fas fa-lock"></i> Подтвердите пароль
                            </label>
                            <input type="password" id="register-password-confirm" required 
                                   placeholder="Повторите пароль">
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-user-plus"></i> Зарегистрироваться
                        </button>
                        
                        <div class="auth-links">
                            <a href="#" id="show-login-from-register">
                                Уже есть аккаунт? Войти
                            </a>
                        </div>
                    </form>
                    
                    <button class="btn btn-ghost btn-block" id="back-to-welcome-from-register">
                        <i class="fas fa-arrow-left"></i> Назад
                    </button>
                </div>
            </section>

            <!-- Экран профиля (показывается после входа) -->
            <section id="profile-screen" class="screen">
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="avatar">
                            <i class="fas fa-user-secret"></i>
                        </div>
                        <div class="profile-info">
                            <h2 id="profile-username">Загрузка...</h2>
                            <p class="profile-email" id="profile-email">...</p>
                            <div class="profile-rating">
                                <i class="fas fa-star"></i>
                                <span id="profile-rating">1000</span>
                                <span class="rank" id="profile-rank">Новичок</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <h3><i class="fas fa-chart-bar"></i> Статистика</h3>
                        <div class="stats-grid">
                            <div class="stat">
                                <div class="stat-value" id="stat-games">0</div>
                                <div class="stat-label">Игр сыграно</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="stat-wins">0</div>
                                <div class="stat-label">Побед</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="stat-winrate">0%</div>
                                <div class="stat-label">Процент побед</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="stat-best-time">--:--</div>
                                <div class="stat-label">Лучшее время</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-actions">
                        <button class="btn btn-primary" id="enter-lobby-btn">
                            <i class="fas fa-gamepad"></i> Войти в лобби
                        </button>
                        <button class="btn btn-secondary" id="create-room-btn">
                            <i class="fas fa-plus"></i> Создать комнату
                        </button>
                        <button class="btn btn-ghost" id="edit-profile-btn">
                            <i class="fas fa-edit"></i> Редактировать профиль
                        </button>
                    </div>
                </div>
            </section>

            <!-- Экран лобби -->
            <section id="lobby-screen" class="screen">
                <div class="lobby-card">
                    <div class="lobby-header">
                        <h2><i class="fas fa-door-open"></i> Игровое лобби</h2>
                        <div class="lobby-controls">
                            <button class="btn btn-small" id="refresh-rooms-btn">
                                <i class="fas fa-sync-alt"></i> Обновить
                            </button>
                            <button class="btn btn-small" id="back-to-profile-btn">
                                <i class="fas fa-user"></i> Профиль
                            </button>
                        </div>
                    </div>
                    
                    <div class="lobby-content">
                        <!-- Создание комнаты -->
                        <div class="create-room-section">
                            <h3><i class="fas fa-plus-circle"></i> Создать комнату</h3>
                            <div class="create-room-form">
                                <div class="form-group">
                                    <input type="text" id="room-name-input" 
                                           placeholder="Название комнаты" 
                                           maxlength="30">
                                    <select id="room-max-players">
                                        <option value="2">2 игрока</option>
                                        <option value="4" selected>4 игрока</option>
                                        <option value="6">6 игроков</option>
                                    </select>
                                    <button class="btn btn-primary" id="create-room-btn-lobby">
                                        <i class="fas fa-plus"></i> Создать
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Список комнат -->
                        <div class="rooms-section">
                            <h3><i class="fas fa-list"></i> Доступные комнаты</h3>
                            <div class="rooms-list" id="rooms-list">
                                <!-- Список комнат будет здесь -->
                                <div class="empty-state">
                                    <i class="fas fa-search"></i>
                                    <p>Нет доступных комнат</p>
                                    <p class="hint">Создайте новую комнату или подождите</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Активная комната -->
                        <div class="active-room-section hidden" id="active-room-section">
                            <div class="room-header">
                                <h3 id="room-title">Комната #1</h3>
                                <button class="btn btn-danger btn-small" id="leave-room-btn">
                                    <i class="fas fa-sign-out-alt"></i> Покинуть
                                </button>
                            </div>
                            
                            <div class="room-players">
                                <h4><i class="fas fa-users"></i> Игроки</h4>
                                <div class="players-grid" id="players-grid">
                                    <!-- Игроки будут здесь -->
                                </div>
                            </div>
                            
                            <div class="room-controls">
                                <button class="btn btn-success" id="ready-btn">
                                    <i class="fas fa-check"></i> Готов
                                </button>
                                <button class="btn btn-primary" id="start-game-btn" style="display:none;">
                                    <i class="fas fa-play"></i> Начать игру
                                </button>
                            </div>
                            
                            <!-- Чат комнаты -->
                            <div class="room-chat">
                                <h4><i class="fas fa-comments"></i> Чат комнаты</h4>
                                <div class="chat-messages" id="chat-messages">
                                    <!-- Сообщения будут здесь -->
                                </div>
                                <div class="chat-input">
                                    <input type="text" id="chat-input-field" 
                                           placeholder="Введите сообщение...">
                                    <button class="btn btn-secondary" id="send-chat-btn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Экран игры -->
            <section id="game-screen" class="screen">
                <div class="game-container">
                    <!-- Информация о комнате -->
                    <div class="game-header">
                        <div class="game-info">
                            <h2 id="game-case-title">Дело о пропавшей картине</h2>
                            <div class="game-timer">
                                <i class="fas fa-clock"></i>
                                <span id="game-timer">00:00</span>
                            </div>
                        </div>
                        <button class="btn btn-danger btn-small" id="leave-game-btn">
                            <i class="fas fa-sign-out-alt"></i> Сдаться
                        </button>
                    </div>
                    
                    <div class="game-content">
                        <!-- Игровое поле -->
                        <div class="game-board">
                            <div class="case-info">
                                <h3><i class="fas fa-file-alt"></i> Детали дела</h3>
                                <div class="case-description" id="case-description">
                                    Загрузка деталей дела...
                                </div>
                            </div>
                            
                            <div class="clues-section">
                                <h3><i class="fas fa-magnifying-glass"></i> Найденные улики</h3>
                                <div class="clues-grid" id="clues-grid">
                                    <!-- Улики будут здесь -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Боковая панель -->
                        <div class="game-sidebar">
                            <!-- Игроки -->
                            <div class="game-players">
                                <h3><i class="fas fa-users"></i> Команда детективов</h3>
                                <div class="game-players-list" id="game-players-list">
                                    <!-- Игроки в игре -->
                                </div>
                            </div>
                            
                            <!-- Чат игры -->
                            <div class="game-chat">
                                <h3><i class="fas fa-comments"></i> Обсуждение</h3>
                                <div class="game-chat-messages" id="game-chat-messages">
                                    <!-- Сообщения игры -->
                                </div>
                                <div class="game-chat-input">
                                    <input type="text" id="game-chat-input" 
                                           placeholder="Обсудите улики...">
                                    <button class="btn btn-secondary" id="send-game-chat-btn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Действия -->
                            <div class="game-actions">
                                <h3><i class="fas fa-play-circle"></i> Действия</h3>
                                <button class="btn btn-primary btn-block" id="vote-btn">
                                    <i class="fas fa-vote-yea"></i> Голосовать
                                </button>
                                <button class="btn btn-secondary btn-block" id="examine-btn">
                                    <i class="fas fa-search-plus"></i> Осмотреть
                                </button>
                                <button class="btn btn-ghost btn-block" id="hint-btn">
                                    <i class="fas fa-lightbulb"></i> Подсказка
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Экран лидерборда -->
            <section id="leaderboard-screen" class="screen">
                <div class="leaderboard-card">
                    <h2><i class="fas fa-trophy"></i> Таблица лидеров</h2>
                    
                    <div class="leaderboard-controls">
                        <button class="btn btn-small" id="refresh-leaderboard">
                            <i class="fas fa-sync-alt"></i> Обновить
                        </button>
                    </div>
                    
                    <div class="leaderboard-table">
                        <div class="table-header">
                            <div class="rank-col">Место</div>
                            <div class="player-col">Детектив</div>
                            <div class="rating-col">Рейтинг</div>
                            <div class="games-col">Игр</div>
                            <div class="winrate-col">Побед</div>
                        </div>
                        <div class="table-body" id="leaderboard-body">
                            <!-- Сюда загрузится лидерборд -->
                            <div class="loading">Загрузка рейтинга...</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-ghost btn-block" id="back-from-leaderboard">
                        <i class="fas fa-arrow-left"></i> Назад
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Модальное окно создания комнаты -->
    <div id="create-room-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Создать комнату</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="create-room-form">
                    <div class="form-group">
                        <label for="modal-room-name">Название комнаты</label>
                        <input type="text" id="modal-room-name" 
                               placeholder="Например: Расследование гениального преступления"
                               maxlength="30" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-max-players">Количество игроков</label>
                        <select id="modal-max-players" required>
                            <option value="2">2 игрока</option>
                            <option value="4" selected>4 игрока (оптимально)</option>
                            <option value="6">6 игроков</option>
                            <option value="8">8 игроков</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modal-room-type">Тип игры</label>
                        <select id="modal-room-type">
                            <option value="classic">Классическая игра</option>
                            <option value="timed">Игра на время</option>
                            <option value="hardcore">Хардкор</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Создать
                        </button>
                        <button type="button" class="btn btn-ghost close-modal">
                            Отмена
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно с информацией о комнате -->
    <div id="room-info-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> Информация о комнате</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body" id="room-info-content">
                <!-- Информация будет здесь -->
            </div>
        </div>
    </div>

    <!-- Модальное окно голосования -->
    <div id="vote-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-vote-yea"></i> Голосование</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Выберите подозреваемого или улику:</p>
                <div id="vote-options">
                    <!-- Опции голосования -->
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="submit-vote-btn">
                        Проголосовать
                    </button>
                    <button class="btn btn-ghost close-modal">
                        Отмена
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Уведомления -->
    <div id="notification-container"></div>

    <!-- Подвал -->
    <footer class="footer">
        <div class="container">
            <p>Детектив-Квартет © 2024 | Кооперативная детективная игра</p>
            <p class="version">Версия: 1.0.0 | Сервер: <span id="server-status">онлайн</span></p>
        </div>
    </footer>

    <!-- Скрипты -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/socket.js"></script>
    <script src="/js/game.js"></script>
    <script src="/js/main.js"></script>
</body>
</html>